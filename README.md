# File Integrity Monitor

[![Java CI/CD Pipeline](https://github.com/dezshev/IPPRPO3/actions/workflows/ci-cd.yml/badge.svg?branch=main)](https://github.com/dezshev/IPPRPO3/actions/workflows/ci-cd.yml)

**File Integrity Monitor** — это консольная утилита для контроля целостности файловой системы. Приложение создает "снимки" (snapshots) директорий и сравнивает их, чтобы показать, какие файлы были добавлены, удалены или изменены.
## Описание проекта

Программа предназначена для автоматизированного отслеживания изменений в файловой структуре. Это полезно для:
*   Контроля версий конфигурационных файлов.
*   Обнаружения несанкционированных изменений (безопасность).
*   Анализа релизов ПО.

**Технологический стек:**
*   **Java 11+**: Основной язык разработки (совместимость с JDK 11, 17, 21).
*   **Gradle 7.6.5**: Система автоматизации сборки.
*   **Jackson**: Библиотека для сериализации данных в JSON.
*   **GitHub Actions**: Система CI/CD для автоматической сборки и тестирования (Matrix Build на Ubuntu/Windows).

## Предварительные требования

Перед началом работы убедитесь, что на вашем компьютере установлены Java и Git.

### 1. Java Development Kit (JDK)
Для работы проекта следует использовать **JDK 17**.
Для работы проекта следует использовать **Gradle 8.5**.

**Как проверить наличие:**
Откройте терминал и введите:
```bash
java -version
```
Если вы видите версию 11, 17 или 21 — всё в порядке. Если команда не найдена или там другая версия, следуйте инструкции:

**Установка:**
1.  Перейдите на официальный сайт Oracle: [Скачать JDK 17 Archive](https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html).
2.  Выберите установщик для вашей ОС:
    *   **Windows:** Скачайте `Windows x64 Installer` (файл `.exe`). Запустите его и нажимайте "Next" до завершения.
    *   **Linux (Debian/Ubuntu):** Скачайте `Debian Package` (файл `.deb`) и установите через `sudo dpkg -i <имя_файла>.deb` или `apt install`.
    *   **macOS:** Скачайте `macOS Installer` (файл `.dmg`).
3.  После установки перезапустите терминал и снова проверьте `java -version`.

### 2. Git
Система контроля версий нужна для скачивания проекта.

**Установка:**
1.  Перейдите на сайт [git-scm.com/downloads](https://git-scm.com/downloads).
2.  Скачайте версию для вашей ОС.
3.  При установке на Windows можно оставлять все настройки "по умолчанию" (нажимать Next).

## Установка и запуск

Следуйте этой инструкции по шагам.

### Шаг 1: Клонирование репозитория

Откройте терминал (PowerShell или командную строку) и выполните команды:

```powershell
# Скачиваем проект
git clone https://github.com/dezshev/IPPRPO3.git

# Переходим в папку проекта
cd IPPRPO3
```

### Шаг 2: Настройка конфигурации

Файл конфигурации `app.properties` содержит настройки хэширования и фильтрации файлов. Он исключен из репозитория (в целях безопасности и разделения конфигов), поэтому **его нужно создать вручную**.

1.  Создайте в корне папки проекта (там, где лежит `build.gradle`) новый текстовый файл с именем `app.properties`.
2.  Откройте его любым текстовым редактором (Блокнот, VS Code, IDEA).
3.  Вставьте в него следующий текст:

```properties
# Алгоритм хэширования. Доступные варианты: MD5, SHA-1, SHA-256
hash.algorithm=MD5

# Список расширений файлов, которые программа будет игнорировать (без пробелов после запятой)
scan.ignore.patterns=*.log,*.tmp,*.bak

# Режим работы по умолчанию (если не указаны аргументы)
app.mode=scan
```
4.  Сохраните файл.

### Шаг 3: Сборка проекта

Теперь нужно превратить исходный код в исполняемую программу.

**Для Windows:**
```powershell
.\gradlew.bat clean installDist
```

*Если вы видите сообщение `BUILD SUCCESSFUL`, значит сборка прошла успешно.*

## Запуск тестов

Чтобы убедиться, что внутренняя логика программы работает корректно, запустите автоматические тесты:

**Windows:**
```powershell
.\gradlew.bat test
```

Результаты тестирования можно посмотреть в браузере, открыв файл:
`build/reports/tests/test/index.html`

## Демонстрация работы и использование

В проекте подготовлена папка `test_data` для быстрой проверки. Однако вы можете использовать **любые свои папки**.

*   `test_data/v1` — Исходное состояние файлов.
*   `test_data/v2` — Измененное состояние (файлы добавлены, удалены и изменены).

Мы пройдем полный цикл: Сканирование V1 -> Сканирование V2 -> Сравнение.

### 1. Сканируем исходную версию (Режим Scan)

Мы указываем программе, какую папку сканировать и куда сохранить отчет.

**Параметры:**
*   `SCAN_PATH`: Путь к проверяемой папке (например, `./test_data/v1` или `C:/MyProject`).
*   `SNAPSHOT_OUTPUT`: Путь к файлу, куда сохранить результат (например, `./snapshot_v1.json`).

**Команда для Windows (PowerShell):**
```powershell
$env:SCAN_PATH = "test_data/v1"; $env:SNAPSHOT_OUTPUT = "snapshot_v1.json"; & .\build\install\FileIntegrityMonitor\bin\FileIntegrityMonitor.bat scan
```

### 2. Сканируем измененную версию

Теперь сканируем папку с изменениями (или ту же папку спустя время).

**Параметры:**
*   `SCAN_PATH`: Теперь указываем путь к новой версии папки (например, `./test_data/v2`).
*   `SNAPSHOT_OUTPUT`: Сохраняем в новый файл (например, `./snapshot_v2.json`).

**Команда для Windows (PowerShell):**
```powershell
$env:SCAN_PATH = "test_data/v2"; $env:SNAPSHOT_OUTPUT = "snapshot_v2.json"; & .\build\install\FileIntegrityMonitor\bin\FileIntegrityMonitor.bat scan
```

### 3. Сравнение (Режим Diff)

Сравниваем два созданных JSON-файла, чтобы увидеть разницу.

**Параметры:**
*   `SNAPSHOT_OLD`: Путь к первому файлу снимка (состояние "До").
*   `SNAPSHOT_NEW`: Путь ко второму файлу снимка (состояние "После").

**Команда для Windows (PowerShell):**
```powershell
$env:SNAPSHOT_OLD = "snapshot_v1.json"; $env:SNAPSHOT_NEW = "snapshot_v2.json"; & .\build\install\FileIntegrityMonitor\bin\FileIntegrityMonitor.bat diff
```

### 4. Ожидаемый результат

В консоли отобразится отчет об изменениях:

```text
Comparing: ./snapshot_v1.json vs ./snapshot_v2.json
ADDED: helper.java
CHANGED: utils.java
REMOVED: config.xml
REMOVED: main.java
```

**Пояснение:**
*   `ADDED`: Файл `helper.java` появился в версии v2.
*   `CHANGED`: Файл `utils.java` был изменен.
*   `REMOVED`: Файл `config.xml` был удален.
*   Файл `debug.log` был проигнорирован, так как расширение `*.log` указано в `app.properties` в списке исключений.

> **Как использовать для своих файлов?**
> Просто замените пути в командах. Например, если вы хотите просканировать свою папку `D:\Docs`, то в Windows команда будет выглядеть так:
> `$env:SCAN_PATH="D:\Docs"; ...`

## CI/CD (Автоматизация)

Проект настроен на автоматическую сборку и тестирование при каждом обновлении кода на GitHub.
Настройки находятся в файле: `.github/workflows/ci-cd.yml`.

**Параметры проверки:**
*   **Операционные системы:** Ubuntu, Windows.
*   **Версии Java:** 11, 17, 21.
